<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>MindGym</title>
  <link rel="manifest" href="manifest.webmanifest?v=4">
  <meta name="theme-color" content="#0b1220">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="icon" type="image/png" href="icons/icon-192.png">
  <style>html{background:#0b1220}</style>
  <link rel="stylesheet" href="styles.css?v=4">
</head>
<body>
  <header class="topbar">
    <div class="dot online"></div>
    <h1>MindGym</h1>
    <div class="stats">
      <span id="level">Lvl 1</span>
      <span id="xp">XP 0</span>
      <span id="streak">Streak 0</span>
    </div>
    <button id="btnSettings" class="pill">Settings</button>
  </header>

  <main>
    <section class="hero">
      <h2>Train your mind, daily.</h2>
      <p>Pick a module below. Earn XP, level up, and track streaks. Your progress is saved on your device.</p>
    </section>

    <section class="grid" id="modules">
      <button data-module="focus" class="card"> 
        <strong>Focus Tap</strong><span>Tap the highlighted circle quickly.</span>
      </button>
      <button data-module="circle" class="card">
        <strong>Circle Hunt</strong><span>Find the odd circle among many.</span>
      </button>
      <button data-module="span" class="card">
        <strong>Visual Span</strong><span>Repeat the flashing sequence.</span>
      </button>
      <button data-module="nback" class="card">
        <strong>N-Back beta</strong><span>Match current to N steps back.</span>
      </button>
      <button data-module="matrix" class="card">
        <strong>Matrix Mini (IQ)</strong><span>Raven-style mini puzzles.</span>
      </button>
      <button data-module="notice60" class="card">
        <strong>Noticing 60s</strong><span>Metacognition: notice & log fast.</span>
      </button>
      <button data-module="metacheck" class="card">
        <strong>Meta-Check</strong><span>Quick self-monitor every 30s.</span>
      </button>
      <button data-module="microjournal" class="card">
        <strong>Micro-Journal</strong><span>2-minute reflection with autosave.</span>
      </button>
    </section>

    <section id="panel" class="panel">
      <div class="panel-head">
        <h3 id="panelTitle">Module</h3>
        <div class="actions">
          <button class="btn" id="btnHow">How?</button>
          <button class="btn" id="btnExit">Exit</button>
        </div>
      </div>
      <div class="panel-body">
        <div id="stage"></div>
        <div id="controls" class="controls"></div>
        <div id="hud" class="hud">
          <div>Score: <span id="score">0</span></div>
          <div>Best: <span id="best">0</span></div>
        </div>
      </div>
    </section>
  </main>

  <dialog id="dlgSettings">
    <form method="dialog" class="settings">
      <h4>Settings</h4>
      <label>Theme
        <select id="theme">
          <option value="dark">Dark</option>
          <option value="light">Light</option>
          <option value="amoled">AMOLED</option>
        </select>
      </label>
      <label class="row">
        <input type="checkbox" id="haptics" checked> Haptics
      </label>
      <label class="row">
        <input type="checkbox" id="sounds" checked> Sounds
      </label>
      <label>FPS Cap
        <select id="fps">
          <option>60</option><option>90</option><option>120</option>
        </select>
      </label>
      <menu>
        <button value="close" id="btnCloseSettings" class="pill">Close</button>
        <button type="button" id="btnReset" class="danger">Reset Progress</button>
      </menu>
    </form>
  </dialog>

  <script src="app.js?v=4"></script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try { await navigator.serviceWorker.register('sw.js?v=4'); } catch(e){ console.warn(e); }
      });
    }
  </script>
</body>
</html>
